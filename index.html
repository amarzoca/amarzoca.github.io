<!DOCTYPE html>
<html>
  	<head>

	  	<link rel="stylesheet" href="./css/bootstrap.css" /> 
	    <style type="text/css">
	      html, body, .row, .container-fluid { height: 100%; width:100%; margin: 0; padding: 0;}
	      .row>div {height:100%;}
	      #map-canvas { padding: 0;}
	      #form {padding-top:15px;}
	      
	    </style>

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
		<script src= "http://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
	    <script type="text/javascript" src="./js/bootstrap.js"> </script>
	    <script type="text/javascript"
	      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDDfEGRgJCleog0v6QuMAAa6U-JMObrn68&region=RO">
	    </script>
	    <script type="text/javascript">

	    var map;
	    var geocoder = new google.maps.Geocoder();

	    function getCoord() {
	      	var lat = 45.7597, lng = 21.2300;
	      	var here = new google.maps.LatLng(lat, lng);

	      	if (navigator.geolocation) {
	        	navigator.geolocation.getCurrentPosition(function (res) {
	        		lat = res.coords.latitude;
	        		lng = res.coords.longitude;
	        		here = new google.maps.LatLng(lat, lng);

	        		initialize(here);
	        	});
	    	} 
	    	else { 
	    		initialize(here);
	    	}
	  	}

	    function initialize(here) {
	 
	        var mapOptions = {
	        	center: here,
	        	streetViewControl: true,
	        	zoomControlOptions: {
	        		position: google.maps.ControlPosition.TOP_LEFT
	    		},
	          zoom: 16
	        };

	        map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

	        var marker = new google.maps.Marker({
	      		position: here,
	      		draggable:true,
	      		//icon:

	    	});

	    	var infowindow = new google.maps.InfoWindow({
	      		content: "You are here (drag the marker if needed)"
	  		});

	    	marker.setMap(map)

	    	getMe(here, marker, infowindow,0);

	    	google.maps.event.addListener(marker, 'dragend', function() {
	    		getMe(marker.getPosition(), marker, infowindow,0);
	  		});

	    }

	    function getMe(here, marker, infowindow, which) {

	    	map.setCenter(here);

	    	geocoder.geocode({'location': here}, function(results, status) {
    			if (status == google.maps.GeocoderStatus.OK) {
     				if (results[0]) {
        
        				if(which == 0) {
        					infowindow.setContent("<strong> You are here: </strong> <br>" + results[0].formatted_address);
        					$('#here').val(results[0].formatted_address);
        				}

        				infowindow.open(map, marker);


      				} else {
        				window.alert('No results found');
     				}
			    } else {
			      window.alert('Geocoder failed due to: ' + status);
			  	}
			});

	    }
		
		google.maps.event.addDomListener(window, 'load', getCoord);
	    </script>


	</head>
    <body>
    	
    	<div class="container-fluid">
	  		<div class="row">
	  			<div id="form" class="col-md-3">
	  				<form>
  						<div class="form-group">
				    		<label > I'm leaving from </label>
				    		<input type="text" class="form-control" id="here" placeholder="Enter address or drag marker">
				 		</div>
				  		<div class="form-group">
				    		<label >Friend's leaving from</label>
				    		<input type="password" class="form-control" id="there" placeholder="soon">
						</div>
					</form>
	  			</div>
				<div id="map-canvas" class="col-md-9"></div>
			</div>
		</div> 
		<!--<div id="map-canvas" ></div> -->

	</body>
</html>